import{r as s,f as E,j as e,C as T,L as $,T as L,e as m}from"./index-Bd0lDEMI.js";import{C as n}from"./Card-BLZ6b7c_.js";import{L as _}from"./Loader-BnLytqHI.js";import{F as v,a as q}from"./FormInput-kT7PvXjE.js";import{F as I}from"./FormTextarea-DZyGjP4B.js";import{F as M}from"./FormSubmitButton-D7msHVkw.js";const G=()=>{const[i,x]=s.useState(""),[c,p]=s.useState(5),[u,h]=s.useState([]),[k,g]=s.useState(!0),[j,f]=s.useState(null),[S,b]=s.useState(!1),[N,o]=s.useState(""),[y,l]=s.useState("");localStorage.getItem("token");const w=JSON.parse(localStorage.getItem("usuario")||"{}"),[C]=E(),r=C.get("contenido");s.useEffect(()=>{(async()=>{try{g(!0),f(null);const t=r?`/feedback/${r}`:"/feedback",d=await m.get(t);h(d.data||[])}catch(t){console.error(t),f("No se pudieron cargar los comentarios.")}finally{g(!1)}})()},[r]);const F=async a=>{if(a.preventDefault(),o(""),l(""),!i.trim()){o("El comentario no puede estar vac√≠o");return}try{b(!0),await m.post("/feedback",{id_usuario:w.id,id_contenido:r||null,tipo_feedback:"contenido",calificacion:c,comentario:i}),l("‚úÖ ¬°Gracias por tu opini√≥n!"),x(""),p(5);const t=r?`/feedback/${r}`:"/feedback",d=await m.get(t);h(d.data||[]),setTimeout(()=>l(""),3e3)}catch(t){console.error(t),o("Error al enviar feedback. Intenta de nuevo.")}finally{b(!1)}};return e.jsx(T,{children:e.jsxs("main",{className:"py-6 md:py-8",children:[e.jsxs("section",{className:"text-center mb-8 md:mb-12 px-4 animate-fade-in",children:[e.jsx($,{size:60,className:"md:w-20 md:h-20 mx-auto"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-knowledge-purple mt-4 md:mt-6 mb-2 md:mb-3",children:"Opiniones y Calificaciones"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto text-sm md:text-base px-2",children:"Comparte tu experiencia con nuestra comunidad y ayuda a otros a conocer sobre este contenido."})]}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 mb-10 md:mb-12",children:e.jsxs(n,{children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-extrabold text-knowledge-purple mb-6",children:"üìù Deja tu opini√≥n"}),y&&e.jsx("div",{className:"mb-6 bg-green-50 border-l-4 border-green-400 p-4 rounded-lg animate-scale-in",children:e.jsxs("p",{className:"text-green-700 font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"animate-checkmark",children:"‚úÖ"})," ",y]})}),N&&e.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4 rounded-lg animate-scale-in",children:e.jsxs("p",{className:"text-red-700 font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"animate-shake",children:"‚ö†Ô∏è"})," ",N]})}),e.jsxs("form",{onSubmit:F,className:"space-y-5 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx(v,{icon:"‚≠ê",required:!0,children:"Calificaci√≥n"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(q,{type:"range",min:"1",max:"5",value:c,onChange:a=>p(Number(a.target.value)),className:"flex-1"}),e.jsx("span",{className:"text-3xl font-extrabold text-knowledge-purple min-w-12 text-center",children:c})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsx("span",{children:"Muy malo"}),e.jsx("span",{children:"Excelente"})]})]}),e.jsxs("div",{children:[e.jsx(v,{icon:"üí¨",required:!0,children:"Tu comentario"}),e.jsx(I,{placeholder:"Comparte qu√© te pareci√≥ este contenido...",value:i,onChange:a=>x(a.target.value),rows:5,helperText:"S√© honesto y constructivo. Tu opini√≥n es valiosa.",required:!0})]}),e.jsx(M,{type:"submit",loading:S,icon:"üì§",children:"Enviar Opini√≥n"})]})]})}),e.jsxs("div",{className:"max-w-3xl mx-auto px-4",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-extrabold text-knowledge-purple mb-6 text-center",children:"üí≠ Comentarios de la comunidad"}),k?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(_,{})}):j?e.jsx(n,{children:e.jsx("p",{className:"text-red-600 font-semibold text-center py-8",children:j})}):u.length===0?e.jsx(n,{children:e.jsx("p",{className:"text-gray-600 text-center py-8",children:"A√∫n no hay comentarios. ¬°S√© el primero en compartir tu opini√≥n!"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 stagger-container",children:u.map((a,t)=>e.jsx(L,{text:`Opini√≥n de ${a.nombre} ${a.apellido}. Calificaci√≥n: ${a.calificacion} de 5 estrellas. Comentario: ${a.comentario}`,tag:"div",className:`animate-fade-in-delay-${Math.min(t,3)}`,children:e.jsxs(n,{children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-knowledge-purple text-base md:text-lg",children:[a.nombre," ",a.apellido]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-2xl",children:"‚≠ê"}),e.jsx("span",{className:"font-extrabold text-knowledge-purple text-lg",children:a.calificacion}),e.jsx("span",{className:"text-gray-500 text-sm",children:"/5"})]})]})}),e.jsx("p",{className:"text-gray-700 text-base leading-relaxed",children:a.comentario})]})},a.id_feedback))})]})]})})};export{G as default};
